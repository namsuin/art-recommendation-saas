🎨 Starting Art Recommendation SaaS Server...

🔧 Environment Configuration:

⚠️  WARNINGS:
  - Replicate API not configured (REPLICATE_API_TOKEN missing)

✅ Basic configuration is valid

📋 Configured Services:
  - Supabase: ✅
  - Google Vision: ✅
  - Replicate: ⚠️
  - Clarifai: ✅
  - Stripe: ⚠️


🎉 Art Recommendation SaaS Server Started!
🌐 URL: http://localhost:3000
❤️  Health: http://localhost:3000/api/health
🔧 Status: Simplified version without AI generators
📋 Features: AI Analysis, Authentication, Static Serving
⚡ Performance: Optimized and lightweight

[2025-08-08T13:12:40.736Z] GET /api/health
✅ Supabase connection successful
🚀 Initializing AI Analysis Service...
🔑 Initializing Google Vision with key file: /Users/suin2/art-recommendation-saas/cedar-gift-467808-f9-993fe64d0376.json
📂 Project ID: cedar-gift-467808-f9
✅ Google Vision AI initialized with service account
⚠️ Replicate API token not found
✅ Clarifai API initialized
🔄 Initializing Local CLIP service...
🎯 AI Ensemble Service initialized
✅ AI Ensemble Service initialized
💊 Health check system initialized (30000ms interval)
🎨 WikiArt API initialized (disabled due to API restrictions)
🏛️ Harvard Art Museums API initialized
🏛️ Europeana API initialized (no API key - using demo mode)
🎨 All art source APIs initialized
[2025-08-08T13:13:02.173Z] GET /
[2025-08-08T13:14:52.035Z] GET /
[2025-08-08T13:15:07.679Z] POST /api/analyze
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
🔄 Running 5 services in parallel: google_vision, replicate, clarifai, local_clip, style_transfer
❌ Google Vision API error: {
  message: "ENOENT: no such file or directory, open '/Users/suin2/art-recommendation-saas/cedar-gift-467808-f9-993fe64d0376.json'",
  code: "ENOENT",
  details: undefined,
}
🎨 Extracted 3 colors from keywords: gray, black, white
🔍 Image analysis completed in 3580ms
📈 Confidence boosted to 0.85
💾 Cached analysis result (1/500)
🚀 Optimized analysis completed in 3582ms
📊 Analysis complete. Found 23 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for balance, zen, water, lake, reflection...
🔍 Europeana: Searching for balance, zen, water, lake, reflection...
✅ Harvard: Found 0 artworks
✅ Europeana: Found 0 cultural items
🔍 Found 6 potential artworks
🎨 Got 2 artworks from getArtworkDetails
📊 Ranked artworks: 2
🎯 First artwork: Clock watch with astronomical dial and sundial by Jan Jansen Bockeltz
✅ Retrieved 2 Met Museum artworks
🏛️ Found 2 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 2 local artworks
🔍 Filtered 4 → 4 valid recommendations
✅ Returning 4 total recommendations from Met Museum, Local DB (Bluethumb filtered)
🔑 Supabase admin client: initialized
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 7949ms
[2025-08-08T13:18:39.461Z] GET /
[2025-08-08T13:18:51.310Z] POST /api/analyze
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
🔄 Running 5 services in parallel: google_vision, replicate, clarifai, local_clip, style_transfer
❌ Google Vision API error: {
  message: "ENOENT: no such file or directory, open '/Users/suin2/art-recommendation-saas/cedar-gift-467808-f9-993fe64d0376.json'",
  code: "ENOENT",
  details: undefined,
}
🎨 Extracted 2 colors from keywords: white, yellow
🔍 Image analysis completed in 2814ms
📈 Confidence boosted to 0.85
💾 Cached analysis result (2/500)
🚀 Optimized analysis completed in 2814ms
📊 Analysis complete. Found 22 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: landscape, grass, golf, nature, countryside, sky, rural, soil, field, cloud, sun, country, tree, summer, pasture, lawn, fair weather, farmland, cloudy, hayfield, white, yellow
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: landscape, grass, golf, nature, countryside, sky, rural, soil, field, cloud, sun, country, tree, summer, pasture, lawn, fair weather, farmland, cloudy, hayfield, white, yellow
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for landscape, grass, golf, nature, countryside...
🔍 Europeana: Searching for landscape, grass, golf, nature, countryside...
✅ Harvard: Found 0 artworks
✅ Europeana: Found 0 cultural items
🔍 Found 5 potential artworks
🎨 Got 3 artworks from getArtworkDetails
📊 Ranked artworks: 3
🎯 First artwork: The Penitence of Saint Jerome by Joachim Patinir
✅ Retrieved 3 Met Museum artworks
🏛️ Found 3 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 3 local artworks
⚠️ Invalid image URL: https://upload.wikimedia.org/wikipedia/commons/thumb/d/dd/The_Persistence_of_Memory.jpg/1280px-The_Persistence_of_Memory.jpg (Status: 404)
❌ Excluding artwork with invalid image: The Persistence of Memory
🔍 Filtered 6 → 5 valid recommendations
✅ Returning 5 total recommendations from Met Museum, Local DB (Bluethumb filtered)
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 8203ms
[2025-08-08T13:19:12.184Z] POST /api/multi-analyze
🔍 Analyzing 2 images for user: d443a229-d7de-4840-a621-d82e9ad30619
📸 Processing image 1/2: free-nature-images.jpg
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
📋 Cache hit for image analysis
📊 Analysis complete. Found 22 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: landscape, grass, golf, nature, countryside, sky, rural, soil, field, cloud, sun, country, tree, summer, pasture, lawn, fair weather, farmland, cloudy, hayfield, white, yellow
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: landscape, grass, golf, nature, countryside, sky, rural, soil, field, cloud, sun, country, tree, summer, pasture, lawn, fair weather, farmland, cloudy, hayfield, white, yellow
🔍 Found 0 potential artworks
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for landscape, grass, golf, nature, countryside...
🔍 Europeana: Searching for landscape, grass, golf, nature, countryside...
🎨 Got 0 artworks from getArtworkDetails
📊 Ranked artworks: 0
✅ Retrieved 0 Met Museum artworks
✅ Harvard: Found 0 artworks
✅ Europeana: Found 0 cultural items
🏛️ Found 0 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 0 local artworks
🔍 Filtered 0 → 0 valid recommendations
No matches found, using fallback recommendations
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 190ms
📸 Processing image 2/2: Free-Stock-Photos-01.jpg
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
📋 Cache hit for image analysis
📊 Analysis complete. Found 23 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Found 0 potential artworks
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for balance, zen, water, lake, reflection...
🔍 Europeana: Searching for balance, zen, water, lake, reflection...
🎨 Got 0 artworks from getArtworkDetails
📊 Ranked artworks: 0
✅ Retrieved 0 Met Museum artworks
✅ Harvard: Found 0 artworks
✅ Europeana: Found 0 cultural items
🏛️ Found 0 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 0 local artworks
🔍 Filtered 0 → 0 valid recommendations
No matches found, using fallback recommendations
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 160ms
Failed to get recommendations: 268 |         // Get recommendations based on common patterns
269 |         let recommendations = [];
270 |         if (commonKeywords.length >= 3) {
271 |           try {
272 |             const searchQuery = commonKeywords.slice(0, 5).join(' ');
273 |             const recommendResult = await getAIService().getRecommendations(searchQuery);
                                                               ^
TypeError: getAIService().getRecommendations is not a function. (In 'getAIService().getRecommendations(searchQuery)', 'getAIService().getRecommendations' is undefined)
      at fetch (/Users/suin2/art-recommendation-saas/server.ts:273:58)

[2025-08-08T13:27:39.115Z] GET /
[2025-08-08T13:27:40.634Z] GET /
[2025-08-08T13:27:52.092Z] POST /api/multi-analyze
🔍 Analyzing 1 images for user: d443a229-d7de-4840-a621-d82e9ad30619
📸 Processing image 1/1: Free-Stock-Photos-01.jpg
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
📋 Cache hit for image analysis
📊 Analysis complete. Found 23 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Found 0 potential artworks
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for balance, zen, water, lake, reflection...
💾 Harvard: Using cached results (0 items)
🔍 Europeana: Searching for balance, zen, water, lake, reflection...
💾 Europeana: Using cached results (0 items)
🎨 Got 0 artworks from getArtworkDetails
📊 Ranked artworks: 0
✅ Retrieved 0 Met Museum artworks
🏛️ Found 0 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 0 local artworks
🔍 Filtered 0 → 0 valid recommendations
No matches found, using fallback recommendations
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 794ms
Failed to get recommendations: 268 |         // Get recommendations based on common patterns
269 |         let recommendations = [];
270 |         if (commonKeywords.length >= 3) {
271 |           try {
272 |             const searchQuery = commonKeywords.slice(0, 5).join(' ');
273 |             const recommendResult = await getAIService().getRecommendations(searchQuery);
                                                               ^
TypeError: getAIService().getRecommendations is not a function. (In 'getAIService().getRecommendations(searchQuery)', 'getAIService().getRecommendations' is undefined)
      at fetch (/Users/suin2/art-recommendation-saas/server.ts:273:58)

[2025-08-08T13:28:03.240Z] POST /api/analyze
🔍 Starting optimized image analysis...
🔧 AI Ensemble status: initialized
🔧 Performance Optimizer status: initialized
📋 Cache hit for image analysis
📊 Analysis complete. Found 23 keywords
🎯 Style: mixed, Confidence: 0.85
🔍 Using keyword-based search fallback...
🔍 Searching for artworks with keywords: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Searching multiple art sources in parallel...
🏛️ Searching Met Museum for: balance, zen, water, lake, reflection, harmony, meditation, nature, rock, river, outdoors, no person, peace, composure, pool, stability, boulder, fall, relaxation, park, gray, black, white
🔍 Found 6 potential artworks
🔍 WikiArt: Service disabled due to API restrictions
🔍 Harvard: Searching for balance, zen, water, lake, reflection...
💾 Harvard: Using cached results (0 items)
🔍 Europeana: Searching for balance, zen, water, lake, reflection...
💾 Europeana: Using cached results (0 items)
🎨 Got 2 artworks from getArtworkDetails
📊 Ranked artworks: 2
🎯 First artwork: Clock watch with astronomical dial and sundial by Jan Jansen Bockeltz
✅ Retrieved 2 Met Museum artworks
🏛️ Found 2 Met Museum artworks
🎨 Found 0 WikiArt artworks
🎓 Found 0 Harvard artworks
🇪🇺 Found 0 Europeana items
📚 Found 2 local artworks
🔍 Filtered 4 → 4 valid recommendations
✅ Returning 4 total recommendations from Met Museum, Local DB (Bluethumb filtered)
✅ User upload stored successfully via admin client
✅ Analysis and recommendation complete in 1680ms
