<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>프로필 - AI Art Recommendation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Chart.js for stats visualization -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-50">
    <div id="root" class="min-h-screen">
        <!-- Loading placeholder -->
        <div class="container mx-auto px-4 py-8">
            <h1 class="text-4xl font-bold text-center text-gray-800 mb-8">
                사용자 프로필
            </h1>
            <div class="max-w-md mx-auto bg-white rounded-lg shadow-lg p-6 text-center">
                <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"></div>
                <p class="text-gray-600">로딩 중...</p>
            </div>
        </div>
    </div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { createRoot } = ReactDOM;

        // 아이콘 컴포넌트들
        const HeartIcon = ({ filled = false, className = "w-5 h-5" }) => (
            <svg className={className} fill={filled ? "currentColor" : "none"} stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
            </svg>
        );

        const UserIcon = ({ className = "w-5 h-5" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
            </svg>
        );

        const UploadIcon = ({ className = "w-5 h-5" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
            </svg>
        );

        const StatsIcon = ({ className = "w-5 h-5" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
        );

        const EditIcon = ({ className = "w-5 h-5" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
        );

        const CameraIcon = ({ className = "w-5 h-5" }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
                    d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
            </svg>
        );

        // 통계 카드 컴포넌트
        const StatCard = ({ title, value, icon, color = "blue" }) => (
            <div className="bg-white rounded-lg shadow-lg p-6">
                <div className="flex items-center">
                    <div className={`p-3 rounded-full bg-${color}-100 text-${color}-600 mr-4`}>
                        {icon}
                    </div>
                    <div>
                        <p className="text-sm font-medium text-gray-600">{title}</p>
                        <p className="text-2xl font-bold text-gray-900">{value}</p>
                    </div>
                </div>
            </div>
        );

        // 좋아요한 작품 그리드 컴포넌트
        const LikedArtworkGrid = ({ artworks, onUnlike }) => (
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                {artworks.map((artwork, index) => (
                    <div key={artwork.id || index} className="bg-white rounded-lg shadow-lg overflow-hidden">
                        <img
                            src={artwork.image_url || 'https://via.placeholder.com/300x300?text=No+Image'}
                            alt={artwork.title || '작품'}
                            className="w-full h-48 object-cover"
                            onError={(e) => {
                                e.target.src = 'https://via.placeholder.com/300x300?text=Image+Not+Found';
                            }}
                        />
                        <div className="p-4">
                            <div className="flex justify-between items-start mb-2">
                                <div className="flex-1">
                                    <h3 className="font-semibold text-gray-900">{artwork.title || '제목 없음'}</h3>
                                    <p className="text-sm text-gray-600">{artwork.artist || '작가 미상'}</p>
                                </div>
                                <button
                                    onClick={() => onUnlike(artwork)}
                                    className="text-red-500 hover:text-red-600 ml-2"
                                    title="좋아요 취소"
                                >
                                    <HeartIcon filled={true} />
                                </button>
                            </div>
                            <p className="text-xs text-gray-500">
                                좋아요 날짜: {new Date(artwork.liked_at || Date.now()).toLocaleDateString()}
                            </p>
                        </div>
                    </div>
                ))}
            </div>
        );

        // 프로필 편집 모달 컴포넌트
        const ProfileEditModal = ({ isOpen, onClose, user, onSave }) => {
            const [displayName, setDisplayName] = useState(user?.display_name || user?.user_metadata?.display_name || '');
            const [nickname, setNickname] = useState(user?.user_metadata?.nickname || '');
            const [profileImage, setProfileImage] = useState(null);
            const [profileImagePreview, setProfileImagePreview] = useState(user?.user_metadata?.profile_image_url || null);
            const [isLoading, setIsLoading] = useState(false);
            const [error, setError] = useState('');

            // 닉네임 추천 목록
            const nicknameOptions = [
                '아트러버', '작품감상가', '미술애호가', '갤러리워커', '컬렉터', '크리에이터',
                '아티스트', '뮤지엄키퍼', '예술탐험가', '색채마법사', '붓질달인', '캔버스드리머'
            ];

            const handleImageChange = (e) => {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        setError('이미지 크기는 5MB 이하여야 합니다.');
                        return;
                    }
                    if (!file.type.startsWith('image/')) {
                        setError('이미지 파일만 업로드 가능합니다.');
                        return;
                    }
                    setError('');
                    setProfileImage(file);
                    
                    // 미리보기 생성
                    const reader = new FileReader();
                    reader.onload = (e) => setProfileImagePreview(e.target.result);
                    reader.readAsDataURL(file);
                }
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsLoading(true);
                setError('');

                try {
                    const formData = new FormData();
                    formData.append('userId', user.id);
                    if (displayName.trim()) formData.append('displayName', displayName.trim());
                    if (nickname.trim()) formData.append('nickname', nickname.trim());
                    if (profileImage) formData.append('profileImage', profileImage);

                    const response = await fetch('/api/profile/update', {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        throw new Error(`서버 오류: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    console.log('Profile update result:', result);
                    
                    if (result.success) {
                        // 사용자 정보 업데이트
                        const updatedUser = { 
                            ...user, 
                            display_name: displayName || user.email,
                            user_metadata: {
                                ...user.user_metadata,
                                display_name: displayName,
                                nickname,
                                profile_image_url: result.profileImageUrl || profileImagePreview
                            }
                        };
                        
                        console.log('Updated user data:', updatedUser);
                        onSave(updatedUser);
                        onClose();
                    } else {
                        setError(result.error || '프로필 업데이트에 실패했습니다.');
                    }
                } catch (error) {
                    console.error('Profile update failed:', error);
                    setError('프로필 업데이트 중 오류가 발생했습니다.');
                } finally {
                    setIsLoading(false);
                }
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                    <div className="bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
                        <div className="flex justify-between items-center mb-6">
                            <h2 className="text-xl font-semibold">프로필 편집</h2>
                            <button
                                onClick={onClose}
                                className="text-gray-500 hover:text-gray-700"
                            >
                                ✕
                            </button>
                        </div>

                        <form onSubmit={handleSubmit} className="space-y-4">
                            {/* 프로필 사진 */}
                            <div className="text-center">
                                <div className="relative inline-block">
                                    <div className="w-24 h-24 rounded-full overflow-hidden bg-gray-200 mx-auto">
                                        {profileImagePreview ? (
                                            <img 
                                                src={profileImagePreview} 
                                                alt="Profile" 
                                                className="w-full h-full object-cover"
                                            />
                                        ) : (
                                            <div className="w-full h-full flex items-center justify-center">
                                                <UserIcon className="w-8 h-8 text-gray-400" />
                                            </div>
                                        )}
                                    </div>
                                    <label className="absolute bottom-0 right-0 bg-blue-500 text-white p-2 rounded-full cursor-pointer hover:bg-blue-600">
                                        <CameraIcon className="w-4 h-4" />
                                        <input
                                            type="file"
                                            accept="image/*"
                                            onChange={handleImageChange}
                                            className="hidden"
                                        />
                                    </label>
                                </div>
                                <p className="text-sm text-gray-500 mt-2">프로필 사진 (5MB 이하)</p>
                            </div>

                            {/* 표시 이름 */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    표시 이름
                                </label>
                                <input
                                    type="text"
                                    value={displayName}
                                    onChange={(e) => setDisplayName(e.target.value)}
                                    placeholder="다른 사용자에게 표시될 이름"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                                />
                            </div>

                            {/* 닉네임 선택 */}
                            <div>
                                <label className="block text-sm font-medium text-gray-700 mb-2">
                                    닉네임 (별명)
                                </label>
                                <input
                                    type="text"
                                    value={nickname}
                                    onChange={(e) => setNickname(e.target.value)}
                                    placeholder="원하는 닉네임을 입력하거나 아래에서 선택"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 mb-3"
                                />
                                
                                <div className="grid grid-cols-2 gap-2">
                                    {nicknameOptions.map((option, index) => (
                                        <button
                                            key={index}
                                            type="button"
                                            onClick={() => setNickname(option)}
                                            className="p-2 text-sm bg-gray-100 hover:bg-blue-100 text-gray-700 hover:text-blue-700 rounded border"
                                        >
                                            {option}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {error && (
                                <div className="p-3 bg-red-100 border border-red-400 text-red-700 rounded">
                                    {error}
                                </div>
                            )}

                            <div className="flex space-x-3 pt-4">
                                <button
                                    type="button"
                                    onClick={onClose}
                                    className="flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"
                                >
                                    취소
                                </button>
                                <button
                                    type="submit"
                                    disabled={isLoading}
                                    className="flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:bg-blue-300"
                                >
                                    {isLoading ? '저장 중...' : '저장'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        };

        // 업로드 히스토리 컴포넌트
        const UploadHistory = ({ history }) => (
            <div className="space-y-4">
                {history.map((item, index) => (
                    <div key={item.id || index} className="bg-white rounded-lg shadow p-6">
                        <div className="flex justify-between items-start mb-3">
                            <div>
                                <h3 className="font-semibold text-gray-900">업로드 #{item.id}</h3>
                                <p className="text-sm text-gray-600">
                                    {new Date(item.upload_date).toLocaleDateString()}
                                </p>
                            </div>
                            <span className="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">
                                {item.style}
                            </span>
                        </div>
                        
                        <div className="mb-3">
                            <p className="text-sm text-gray-600 mb-2">추출된 키워드:</p>
                            <div className="flex flex-wrap gap-2">
                                {item.keywords.map((keyword, idx) => (
                                    <span key={idx} className="px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded">
                                        {keyword}
                                    </span>
                                ))}
                            </div>
                        </div>
                        
                        <p className="text-sm text-gray-600">
                            추천 작품 수: <span className="font-semibold">{item.recommendations_count}개</span>
                        </p>
                    </div>
                ))}
            </div>
        );

        // 메인 프로필 앱 컴포넌트
        const ProfileApp = () => {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState('liked');
            const [likedArtworks, setLikedArtworks] = useState([]);
            const [uploadHistory, setUploadHistory] = useState([]);
            const [stats, setStats] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [isEditModalOpen, setIsEditModalOpen] = useState(false);

            // 사용자 정보 로드
            const loadUser = async () => {
                try {
                    // localStorage에서 저장된 토큰 가져오기
                    const accessToken = localStorage.getItem('supabase_access_token');
                    const userInfo = localStorage.getItem('user_info');
                    
                    console.log('🔍 프로필 페이지 인증 확인:');
                    console.log('  - 토큰 있음:', !!accessToken);
                    console.log('  - 사용자 정보 있음:', !!userInfo);
                    
                    const headers = {
                        'Content-Type': 'application/json'
                    };
                    
                    // 토큰이 있으면 Authorization 헤더에 추가
                    if (accessToken) {
                        headers['Authorization'] = `Bearer ${accessToken}`;
                    }
                    
                    const response = await fetch('/api/auth/user', { headers });
                    const result = await response.json();
                    
                    if (result.success) {
                        console.log('✅ 사용자 인증 성공:', result.user.email);
                        setUser(result.user);
                        return result.user;
                    } else {
                        console.log('❌ 사용자 인증 실패:', result.error);
                        
                        // 토큰이 만료되었거나 유효하지 않은 경우 localStorage 정리
                        if (accessToken) {
                            localStorage.removeItem('supabase_access_token');
                            localStorage.removeItem('user_info');
                        }
                        
                        setError('로그인이 필요합니다.');
                        return null;
                    }
                } catch (error) {
                    console.error('사용자 정보 로드 실패:', error);
                    setError('사용자 정보를 불러올 수 없습니다.');
                    return null;
                }
            };

            // 좋아요한 작품 로드
            const loadLikedArtworks = async (userId) => {
                try {
                    const response = await fetch(`/api/profile/liked-artworks?userId=${userId}&limit=20`);
                    const result = await response.json();
                    if (result.success) {
                        setLikedArtworks(result.likedArtworks || []);
                    }
                } catch (error) {
                    console.error('Failed to load liked artworks:', error);
                }
            };

            // 업로드 히스토리 로드
            const loadUploadHistory = async (userId) => {
                try {
                    const response = await fetch(`/api/profile/upload-history?userId=${userId}&limit=10`);
                    const result = await response.json();
                    if (result.success) {
                        setUploadHistory(result.history || []);
                    }
                } catch (error) {
                    console.error('Failed to load upload history:', error);
                }
            };

            // 통계 로드
            const loadStats = async (userId) => {
                try {
                    const response = await fetch(`/api/profile/stats?userId=${userId}`);
                    const result = await response.json();
                    if (result.success) {
                        setStats(result.stats);
                    }
                } catch (error) {
                    console.error('Failed to load stats:', error);
                }
            };

            // 좋아요 취소
            const handleUnlike = async (artwork) => {
                if (!user) return;
                
                try {
                    const response = await fetch('/api/social/artwork/unlike', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            userId: user.id,
                            artworkId: artwork.id,
                            sourcePlatform: artwork.source_platform || 'met'
                        })
                    });
                    
                    const result = await response.json();
                    if (result.success) {
                        // 목록에서 제거
                        setLikedArtworks(prev => prev.filter(a => a.id !== artwork.id));
                        // 통계 업데이트
                        if (stats) {
                            setStats(prev => ({ ...prev, total_likes: prev.total_likes - 1 }));
                        }
                    } else {
                        alert('좋아요 취소에 실패했습니다: ' + result.error);
                    }
                } catch (error) {
                    console.error('Unlike failed:', error);
                    alert('좋아요 취소 중 오류가 발생했습니다.');
                }
            };

            useEffect(() => {
                const initializeProfile = async () => {
                    const userData = await loadUser();
                    if (userData) {
                        await Promise.all([
                            loadLikedArtworks(userData.id),
                            loadUploadHistory(userData.id),
                            loadStats(userData.id)
                        ]);
                    }
                    setLoading(false);
                };
                
                initializeProfile();
            }, []);

            if (loading) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"></div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="min-h-screen flex items-center justify-center">
                        <div className="text-center">
                            <p className="text-red-600 mb-4">{error}</p>
                            <a href="/" className="text-blue-500 hover:text-blue-600">
                                홈으로 돌아가기
                            </a>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gray-50">
                    {/* 헤더 */}
                    <header className="bg-white shadow-sm border-b">
                        <div className="container mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                <a href="/" className="text-2xl font-bold text-gray-800 hover:text-blue-600 transition-colors">
                                    AI Art Recommendation
                                </a>
                                <div className="flex items-center space-x-4">
                                    <a href="/social" className="text-gray-600 hover:text-blue-600">커뮤니티</a>
                                    <span className="text-gray-700">{user?.display_name || user?.email}</span>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* 메인 컨텐츠 */}
                    <main className="container mx-auto px-4 py-8">
                        {/* 프로필 편집 모달 */}
                        <ProfileEditModal 
                            isOpen={isEditModalOpen} 
                            onClose={() => setIsEditModalOpen(false)}
                            user={user}
                            onSave={async (updatedUser) => {
                                console.log('Profile updated, refreshing user data...');
                                // 사용자 정보를 서버에서 다시 로드
                                const refreshedUser = await loadUser();
                                // 통계도 다시 로드
                                if (refreshedUser?.id) {
                                    await loadStats(refreshedUser.id);
                                }
                                console.log('Profile refresh complete');
                            }}
                        />

                        {/* 프로필 헤더 */}
                        <div className="bg-white rounded-lg shadow-lg p-6 mb-8">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div className="w-20 h-20 bg-gray-300 rounded-full overflow-hidden flex items-center justify-center">
                                        {user?.user_metadata?.profile_image_url ? (
                                            <img 
                                                src={user.user_metadata.profile_image_url} 
                                                alt="Profile" 
                                                className="w-full h-full object-cover"
                                            />
                                        ) : (
                                            <UserIcon className="w-10 h-10 text-gray-500" />
                                        )}
                                    </div>
                                    <div>
                                        <h1 className="text-3xl font-bold text-gray-800">
                                            {user?.display_name || user?.user_metadata?.display_name || user?.email || '사용자'}
                                        </h1>
                                        <p className="text-gray-600">
                                            {user?.user_metadata?.nickname && (
                                                <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded text-sm mr-2">
                                                    {user.user_metadata.nickname}
                                                </span>
                                            )}
                                            AI 아트 애호가 • 회원 가입일: {stats ? new Date(stats.member_since).toLocaleDateString() : '알 수 없음'}
                                        </p>
                                    </div>
                                </div>
                                <button
                                    onClick={() => setIsEditModalOpen(true)}
                                    className="flex items-center space-x-2 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg"
                                >
                                    <EditIcon className="w-4 h-4" />
                                    <span>편집</span>
                                </button>
                            </div>
                        </div>

                        {/* 통계 카드들 */}
                        {stats && (
                            <div className="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                                <StatCard 
                                    title="총 업로드" 
                                    value={stats.total_uploads} 
                                    icon={<UploadIcon />} 
                                    color="blue" 
                                />
                                <StatCard 
                                    title="좋아요한 작품" 
                                    value={stats.total_likes} 
                                    icon={<HeartIcon />} 
                                    color="red" 
                                />
                                <StatCard 
                                    title="선호 스타일" 
                                    value={stats.favorite_styles[0] || '없음'} 
                                    icon={<StatsIcon />} 
                                    color="green" 
                                />
                                <StatCard 
                                    title="활동 점수" 
                                    value={stats.total_uploads + stats.total_likes} 
                                    icon={<StatsIcon />} 
                                    color="purple" 
                                />
                            </div>
                        )}

                        {/* 탭 네비게이션 */}
                        <div className="bg-white rounded-lg shadow-lg mb-6">
                            <div className="border-b">
                                <nav className="flex">
                                    <button
                                        onClick={() => setActiveTab('liked')}
                                        className={`px-6 py-4 font-medium ${
                                            activeTab === 'liked'
                                                ? 'border-b-2 border-blue-500 text-blue-600'
                                                : 'text-gray-600 hover:text-blue-600'
                                        }`}
                                    >
                                        좋아요한 작품 ({likedArtworks.length})
                                    </button>
                                    <button
                                        onClick={() => setActiveTab('history')}
                                        className={`px-6 py-4 font-medium ${
                                            activeTab === 'history'
                                                ? 'border-b-2 border-blue-500 text-blue-600'
                                                : 'text-gray-600 hover:text-blue-600'
                                        }`}
                                    >
                                        업로드 히스토리 ({uploadHistory.length})
                                    </button>
                                </nav>
                            </div>

                            {/* 탭 컨텐츠 */}
                            <div className="p-6">
                                {activeTab === 'liked' && (
                                    <div>
                                        <h2 className="text-xl font-semibold mb-4">좋아요한 작품</h2>
                                        {likedArtworks.length > 0 ? (
                                            <LikedArtworkGrid 
                                                artworks={likedArtworks} 
                                                onUnlike={handleUnlike} 
                                            />
                                        ) : (
                                            <div className="text-center py-12">
                                                <HeartIcon className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                                                <p className="text-gray-500 text-lg">아직 좋아요한 작품이 없습니다.</p>
                                                <p className="text-gray-400">작품을 탐색하고 마음에 드는 작품에 좋아요를 눌러보세요!</p>
                                                <a 
                                                    href="/" 
                                                    className="inline-block mt-4 bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg"
                                                >
                                                    작품 탐색하기
                                                </a>
                                            </div>
                                        )}
                                    </div>
                                )}

                                {activeTab === 'history' && (
                                    <div>
                                        <h2 className="text-xl font-semibold mb-4">업로드 히스토리</h2>
                                        {uploadHistory.length > 0 ? (
                                            <UploadHistory history={uploadHistory} />
                                        ) : (
                                            <div className="text-center py-12">
                                                <UploadIcon className="w-16 h-16 text-gray-300 mx-auto mb-4" />
                                                <p className="text-gray-500 text-lg">아직 업로드한 이미지가 없습니다.</p>
                                                <p className="text-gray-400">이미지를 업로드하여 AI 분석과 추천을 받아보세요!</p>
                                                <a 
                                                    href="/" 
                                                    className="inline-block mt-4 bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg"
                                                >
                                                    이미지 업로드하기
                                                </a>
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>
                        </div>
                    </main>
                </div>
            );
        };

        // 앱 렌더링
        const rootElement = document.getElementById('root');
        if (rootElement) {
            const root = createRoot(rootElement);
            root.render(<ProfileApp />);
        }
    </script>
</body>
</html>